
Code's a bit messy and could be optimized.
